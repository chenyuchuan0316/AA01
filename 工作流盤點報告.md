# 工作流盤點報告

## .github/workflows/ci.yml（CI）

- **on**：`pull_request`（opened、synchronize、reopened、ready_for_review）、`workflow_dispatch`
- **lint**：✅ `npm run lint`
- **test**：✅ `npm test -- --runInBand`
- **e2e**：✅ `npm run e2e:ui`、條件式遠端 `npm run e2e:remote`
- **a11y**：✅ `npm run test:a11y:pa11y`
- **health**：✅ `node scripts/health-check.mjs`（可繼續失敗）
- **備註**：單一 PR CI 串連 Install→Lint→Jest→Playwright→Health→Pa11y→Remote（需同時具備 GAS URL 與 auth）。

## .github/workflows/ci-preview.yml

- **on**：`workflow_dispatch`
- **lint**：❌
- **test**：❌
- **e2e**：✅ 僅在雙 Secret 存在時執行 `npm run e2e:remote`
- **a11y**：❌
- **health**：✅ `node scripts/health-check.mjs`
- **備註**：手動佈署到 staging 後，保留遠端冒煙與健康報告；其他測試交由 CI 處理。

## .github/workflows/codex-audit.yml

- **on**：`issue_comment`（含 `/audit` 指令）、`workflow_dispatch`
- **lint**：✅ `npm run lint`
- **test**：✅ `npm run test -- --coverage`
- **e2e**：✅ `npm run e2e`（失敗不終止流程）
- **a11y**：❌
- **health**：❌
- **備註**：第二階段額外執行 `npx jscpd`、`npx madge`、`npx knip` 產出稽核 artifacts。

## .github/workflows/gas-deploy.yml

- **on**：`workflow_dispatch`
- **lint**：❌
- **test**：❌
- **e2e**：✅ 僅在雙 Secret 存在時執行 `npm run e2e:remote`
- **a11y**：❌
- **health**：✅ `node scripts/health-check.mjs`
- **備註**：聚焦部署所需的 clasp 步驟，保留遠端冒煙與健康檢查。

## .github/workflows/npm-auto-upgrade.yml

- **on**：`schedule`（每週一 01:30 UTC）、`workflow_dispatch`
- **lint**：❌
- **test**：❌
- **e2e**：❌
- **a11y**：❌
- **health**：❌
- **備註**：僅升級套件與建立 PR，測試結果請參考主 CI。

## .github/workflows/npm-outdated.yml

- **on**：`schedule`（每週一 01:00 UTC）、`workflow_dispatch`
- **lint**：❌
- **test**：❌
- **e2e**：❌
- **a11y**：❌
- **health**：❌
- **備註**：僅輸出 `outdated.json` 與 Summary，測試交回 CI。

## .github/workflows/predeploy.yml

- **on**：`push`（main）、`workflow_dispatch`
- **lint**：❌
- **test**：❌
- **e2e**：❌
- **a11y**：❌
- **health**：❌
- **備註**：主要處理 `clasp version` 與 `clasp deploy`，確保 PROD Deployment 指向最新版本。

## .github/workflows/\_tmpl_clasp.json

- **on**：❌（僅模板檔案）
- **lint/test/e2e/a11y/health**：不適用
- **備註**：作為自訂 Workflow 樣板，不由 GitHub Actions 直接執行。
